package io.testproject.generated.tests.xattaxgrouptestcases;

import io.testproject.addon.VisibleElementsOperations;
import io.testproject.sdk.drivers.ReportingDriver;
import io.testproject.sdk.interfaces.junit5.ExceptionsReporter;
import java.lang.Exception;
import java.lang.Override;
import java.lang.String;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.Select;

/**
 * This class was automatically generated by TestProject
 * Project: Xattax-Group Test Cases
 * Test: TC-07-Xattax-Cancelled E-Invoice
 * Generated by: Suganya Jothiprakash (suganya.sugan@sailotech.net)
 * Generated on Fri Dec 17 18:43:13 GMT 2021.
 */
public class Tc07xattaxcancelledEinvoice implements Test, ExceptionsReporter {
  public static WebDriver driver;

  /**
   * ApplicationURL test parameter
   */
  public String ApplicationURL = "http://175.101.240.71:9791/XATTAXEInvoice1.5/login";

  /**
   * Username test parameter
   */
  public String Username = "einvuser1";

  /**
   * Password test parameter
   */
  public String Password = "1234";

  /**
   * GeneratedInvoiceSearcField test parameter
   */
  public String GeneratedInvoiceSearcField = "1224";

  /**
   * Path test parameter
   */
  public String Path = "C:\\Users\\sukki\\Dropbox\\My PC (DESKTOP-A4GJKOM)\\Desktop\\Xattax Excel Files\\E_Invoice_XLSX_SampleData.xlsx";

  /**
   * ImportSearchInvoice test parameter
   */
  public String ImportSearchInvoice = "E_Invoice_SampleTemplate (9).xlsx";

  /**
   * TransactionSummary test parameter
   */
  public String TransactionSummary = "";

  /**
   * RecordDetails test parameter
   */
  public String RecordDetails = "";

  /**
   * SendEmail test parameter
   */
  public String SendEmail = "suganya.sugan@sailotech.net";

  /**
   * TransID test parameter
   */
  public String TransID = "01AMBPG7773M002";

  /**
   * TransName test parameter
   */
  public String TransName = "ABC";

  /**
   * Distance test parameter
   */
  public String Distance = "0";

  /**
   * VehicleNumber test parameter
   */
  public String VehicleNumber = "AP20AG1234";

  /**
   * TransDocNumber test parameter
   */
  public String TransDocNumber = "324";

  /**
   * TransDocDate test parameter
   */
  public String TransDocDate = "16/12/2021";

  /**
   * ShippingToLocation test parameter
   */
  public String ShippingToLocation = "Other country";

  /**
   * ShippingToAddress2 test parameter
   */
  public String ShippingToAddress2 = "Chandigargh";

  /**
   * ShippingPincode test parameter
   */
  public String ShippingPincode = "160001";

  /**
   * ShippingToAddress1 test parameter
   */
  public String ShippingToAddress1 = "Punjab";

  /**
   * ToBeGeneratedSearchField test parameter
   */
  public String ToBeGeneratedSearchField = "SFD12162021152";

  /**
   * ReasonForCancel test parameter
   */
  public String ReasonForCancel = "Duplicate";

  /**
   * CancelSearchField test parameter
   */
  public String CancelSearchField = "SS04";

  /**
   * FailedSearchField test parameter
   */
  public String FailedSearchField = "SS1216202164";

  public void execute(WebDriver parentDriver) throws Exception {
    driver = parentDriver;
    // set timeout for driver actions (similar to step timeout)
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);
    By by;
    boolean booleanResult;
    VisibleElementsOperations.GetTextIfVisibleWeb getTextIfVisibleWeb;

    // 1. Click 'Canceled'
    //    Click on Cancelled Tab
    GeneratedUtils.sleep(500);
    by = By.xpath("//a[. = ' Canceled']");
    driver.findElement(by).click();

    // 2. Click 'INPUT4'
    //    Click on Search Field in Cancelled Invoice Tab
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div/div/div/div/div[2]//input");
    driver.findElement(by).click();

    // 3. Type '{{CancelSearchField}}' in 'INPUT4'
    //    Enter the value for search field
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div/div/div/div/div[2]//input");
    driver.findElement(by).sendKeys(CancelSearchField);

    // 4. Send 'ENTER' key(s)
    //    Press the Enter key
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div/div/div/div/div[2]//input");
    (new Actions(driver)).sendKeys(GeneratedUtils.getKeys("ENTER")).build().perform();

    // 5. Click 'Edit1'
    //    Click on Edit Button
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div/div/div/div/table//button");
    driver.findElement(by).click();

    // 6. Click 'Back'
    //    Click on Back Button
    GeneratedUtils.sleep(500);
    by = By.xpath("//a[. = ' Back']");
    driver.findElement(by).click();

    // 7. Click 'Generated'
    //    Click on Generated Tab
    GeneratedUtils.sleep(500);
    by = By.xpath("//a[. = ' Generated']");
    driver.findElement(by).click();

    // 8. Click 'Edit2'
    //    Click on Edit Button
    GeneratedUtils.sleep(500);
    by = By.xpath("//tr[1]/td[10]/button");
    driver.findElement(by).click();

    // 9. Click 'Cancel e-Invoice'
    //    Click on cancel Button
    GeneratedUtils.sleep(500);
    by = By.cssSelector("#cancelButton");
    driver.findElement(by).click();

    // 10. Click 'cnlRsn'
    //    Click on Reason Drop down Menu
    GeneratedUtils.sleep(500);
    by = By.xpath("/html/body/div[2]/div[2]/div/div/div[3]/div[2]/div[2]/div/div[2]/form/div[2]/div[2]/div/div/select");
    driver.findElement(by).click();

    // 11. Select the '1' option in 'cnlRsn'
    //    Select the First Option
    GeneratedUtils.sleep(500);
    by = By.xpath("/html/body/div[2]/div[2]/div/div/div[3]/div[2]/div[2]/div/div[2]/form/div[2]/div[2]/div/div/select");
    (new Select(driver.findElement(by))).selectByValue("1");

    // 12. Click 'cnlRem'
    //    Click on Reason for cancel
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div[2]//textarea");
    driver.findElement(by).click();

    // 13. Type '{{ReasonForCancel}}' in 'cnlRem'
    //    Enter the Reason for Cancel
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[2]/div/div[2]//textarea");
    driver.findElement(by).sendKeys(ReasonForCancel);

    // 14. Click 'Cancel IRN'
    //    Click on cancel IRN
    GeneratedUtils.sleep(500);
    by = By.xpath("//button[. = '\n										 Cancel IRN\n									']");
    driver.findElement(by).click();

    // 15. Click 'DIV2'
    //    Click on Pop Up Message
    GeneratedUtils.sleep(500);
    by = By.xpath("//body/div[6]");
    driver.findElement(by).click();

    // 16. Get text from 'DIV2' if it's visible
    //    Get the Text from pop up window
    GeneratedUtils.sleep(500);
    getTextIfVisibleWeb = VisibleElementsOperations.getTextIfVisibleWeb("");
    by = By.xpath("//body/div[6]");
    getTextIfVisibleWeb = (VisibleElementsOperations.GetTextIfVisibleWeb)((ReportingDriver)driver).addons().execute(getTextIfVisibleWeb, by, -1);

    // 17. Click 'OK'
    //    Click on OK Button
    GeneratedUtils.sleep(500);
    by = By.xpath("//button[. = 'OK']");
    driver.findElement(by).click();

  }

  @Override
  public ReportingDriver getDriver() {
    return (ReportingDriver) driver;
  }
}
