package io.testproject.generated.tests.xattaxgrouptestcases;

import io.testproject.addon.VisibleElementsOperations;
import io.testproject.sdk.drivers.ReportingDriver;
import io.testproject.sdk.interfaces.junit5.ExceptionsReporter;
import java.lang.Exception;
import java.lang.Override;
import java.lang.String;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.interactions.Actions;

/**
 * This class was automatically generated by TestProject
 * Project: Xattax-Group Test Cases
 * Test: TC-03-Xattax-Generated Invoices
 * Generated by: Suganya Jothiprakash (suganya.sugan@sailotech.net)
 * Generated on Fri Dec 17 18:43:13 GMT 2021.
 */
public class Tc03xattaxgeneratedInvoices implements Test, ExceptionsReporter {
  public static WebDriver driver;

  /**
   * ApplicationURL test parameter
   */
  public String ApplicationURL = "http://175.101.240.71:9791/XATTAXEInvoice1.5/login";

  /**
   * Username test parameter
   */
  public String Username = "einvuser1";

  /**
   * Password test parameter
   */
  public String Password = "1234";

  /**
   * GeneratedInvoiceSearcField test parameter
   */
  public String GeneratedInvoiceSearcField = "HIVUJV";

  /**
   * Path test parameter
   */
  public String Path = "C:\\Users\\sukki\\Dropbox\\My PC (DESKTOP-A4GJKOM)\\Desktop\\Xattax Excel Files\\E_Invoice_XLSX_SampleData.xlsx";

  /**
   * ImportSearchInvoice test parameter
   */
  public String ImportSearchInvoice = "E_Invoice_SampleTemplate (9).xlsx";

  /**
   * TransactionSummary test parameter
   */
  public String TransactionSummary = "";

  /**
   * RecordDetails test parameter
   */
  public String RecordDetails = "";

  /**
   * SendToEmail test parameter
   */
  public String SendToEmail = "suganya.sugan@sailotech.net";

  /**
   * SendCCMail test parameter
   */
  public String SendCCMail = "";

  public void execute(WebDriver parentDriver) throws Exception {
    driver = parentDriver;
    // set timeout for driver actions (similar to step timeout)
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);
    By by;
    boolean booleanResult;
    String string;
    VisibleElementsOperations.GetTextIfVisibleWeb getTextIfVisibleWeb;
    VisibleElementsOperations.ClickIfVisibleWeb clickIfVisibleWeb;

    // 1. Click 'e-Invoice Queue'
    //    Click on E-Invoice Queue in Menu Bar
    // set step-specific timeout (will undo this at the end)
    driver.manage().timeouts().implicitlyWait(35000, TimeUnit.MILLISECONDS);
    GeneratedUtils.sleep(2000);
    by = By.xpath("//span[. = 'e-Invoice Queue']");
    driver.findElement(by).click();
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);

    // 2. Click 'Generated'
    //    Click on Generated Tab
    // set step-specific timeout (will undo this at the end)
    driver.manage().timeouts().implicitlyWait(35000, TimeUnit.MILLISECONDS);
    GeneratedUtils.sleep(2000);
    by = By.xpath("//a[. = ' Generated']");
    driver.findElement(by).click();
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);

    // 3. Click 'INPUT1'
    //    Click on Search Box in Generated Tab
    GeneratedUtils.sleep(1000);
    by = By.xpath("//div[2]/div/div/div/div/div/div/div[1]/div/div/div/div/div[2]//input");
    driver.findElement(by).click();

    // 4. Type '{{GeneratedInvoiceSearcField}}' in 'INPUT1'
    //    Enter the values in Search Text Box in Generated Tab
    GeneratedUtils.sleep(1000);
    by = By.xpath("//div[2]/div/div/div/div/div/div/div[1]/div/div/div/div/div[2]//input");
    driver.findElement(by).sendKeys(GeneratedInvoiceSearcField);

    // 5. Send 'ENTER' key(s)
    //    Press the Enter Key
    GeneratedUtils.sleep(1000);
    (new Actions(driver)).sendKeys(GeneratedUtils.getKeys("ENTER")).build().perform();

    // 6. Click 'Edit'
    //    Click on Edit Button
    GeneratedUtils.sleep(1000);
    by = By.xpath("//td[10]/button");
    driver.findElement(by).click();

    // 7. Click 'Invoice Reference No. :'
    //    Click on Reference No Title
    GeneratedUtils.sleep(1000);
    by = By.xpath("//label[. = 'Invoice Reference No. : ']");
    driver.findElement(by).click();

    // 8. Click 'f0b20f02f93c6ee807fc167df15fa691e59a9...'
    //    Click on Reference Number
    //GeneratedUtils.sleep(500);
    //by = By.xpath("//span[. = 'f0b20f02f93c6ee807fc167df15fa691e59a9d4069fc3a17e578475d4eb19332\n								']");
    //driver.findElement(by).click();

    // 9. Get text from 'f0b20f02f93c6ee807fc167df15fa691e59a9...'
    //    Get the Text from Reference Number
    //GeneratedUtils.sleep(500);
    //by = By.xpath("//span[. = 'f0b20f02f93c6ee807fc167df15fa691e59a9d4069fc3a17e578475d4eb19332\n								']");
    //string = driver.findElement(by).getAttribute("value");

    // 10. Click 'E-Invoice Status :'
    GeneratedUtils.sleep(1000);
    by = By.xpath("//label[. = 'E-Invoice Status : ']");
    driver.findElement(by).click();

    // 11. Click 'DIV1'
    //    Click on Invoice Status
    GeneratedUtils.sleep(1000);
    by = By.xpath("//div[1]/div[1]/div[1]/div//div[3]");
    driver.findElement(by).click();

    // 12. Get text from 'DIV1' if it's visible
    //    Get the Text from Invoice status
    GeneratedUtils.sleep(1000);
    getTextIfVisibleWeb = VisibleElementsOperations.getTextIfVisibleWeb("");
    by = By.xpath("//div[1]/div[1]/div[1]/div//div[3]");
    getTextIfVisibleWeb = (VisibleElementsOperations.GetTextIfVisibleWeb)((ReportingDriver)driver).addons().execute(getTextIfVisibleWeb, by, -1);

    // 13. Click 'Send Mail'
    //    Click on Send Email
    GeneratedUtils.sleep(1000);
    by = By.xpath("//button[. = '\n						 Send Mail\n					']");
    driver.findElement(by).click();

    // 14. Click 'ctrl.toMailId'
    //    Click on Mail Text Box
    GeneratedUtils.sleep(1000);
    by = By.cssSelector("#toMailId");
    driver.findElement(by).click();

    // 15. Clear 'ctrl.toMailId' contents
    //    Clear the To Mail Text Box
    GeneratedUtils.sleep(1000);
    by = By.cssSelector("#toMailId");
    driver.findElement(by).clear();

    // 16. Type '{{SendToEmail}}' in 'ctrl.toMailId'
    //    Enter the values for To  Email Text Box
    GeneratedUtils.sleep(1000);
    by = By.cssSelector("#toMailId");
    driver.findElement(by).sendKeys(SendToEmail);

    // 17. Click 'ctrl.ccMailId'
    //    Click on CC Mail Text Box
    GeneratedUtils.sleep(500);
    by = By.cssSelector("#ccMailId");
    driver.findElement(by).click();

    // 18. Clear 'ctrl.ccMailId' contents
    //    Clear the contents in CC Mail Text Box
    GeneratedUtils.sleep(500);
    by = By.cssSelector("#ccMailId");
    driver.findElement(by).clear();

    // 19. Type '{{SendCCMail}}' in 'ctrl.ccMailId'
    //    Enter the value for CC Mail Id Text box
    GeneratedUtils.sleep(500);
    by = By.cssSelector("#ccMailId");
    driver.findElement(by).sendKeys(SendCCMail);

    // 20. Send 'ENTER' key(s)
    //    Press the enter key
    GeneratedUtils.sleep(500);
    by = By.cssSelector("#ccMailId");
    (new Actions(driver)).sendKeys(GeneratedUtils.getKeys("ENTER")).build().perform();

    // 21. Click 'Send'
    //    Click on Send Button
    GeneratedUtils.sleep(1000);
    by = By.cssSelector("#mailSend");
    driver.findElement(by).click();

    // 22. Click 'Mail sent successfully.' if it's visible
    //    Click on POP UP Message 
    GeneratedUtils.sleep(1000);
    clickIfVisibleWeb = VisibleElementsOperations.clickIfVisibleWeb("");
    by = By.xpath("//div[. = 'Mail sent successfully. ']");
    clickIfVisibleWeb = (VisibleElementsOperations.ClickIfVisibleWeb)((ReportingDriver)driver).addons().execute(clickIfVisibleWeb, by, -1);

    // 23. Get text from 'Mail sent successfully.' if it's visible
    //    Get the Text from pop up Message 
    GeneratedUtils.sleep(1000);
    getTextIfVisibleWeb = VisibleElementsOperations.getTextIfVisibleWeb("");
    by = By.xpath("//div[. = 'Mail sent successfully. ']");
    getTextIfVisibleWeb = (VisibleElementsOperations.GetTextIfVisibleWeb)((ReportingDriver)driver).addons().execute(getTextIfVisibleWeb, by, -1);

    // 24. Click 'Close'
    //    Click on Close Button to close the send mail window
    GeneratedUtils.sleep(1000);
    by = By.xpath("//button[. = '\n										 Close\n									']");
    driver.findElement(by).click();

    // 25. Click 'e-Invoice Download'
    //    Click on E-Invoice Download Button
    GeneratedUtils.sleep(1000);
    by = By.xpath("//button[. = '\n						 e-Invoice\n						Download\n					']");
    driver.findElement(by).click();

  }

  @Override
  public ReportingDriver getDriver() {
    return (ReportingDriver) driver;
  }
}
