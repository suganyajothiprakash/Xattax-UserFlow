package io.testproject.generated.tests.xattaxgrouptestcases;

import io.testproject.addon.VisibleElementsOperations;
import io.testproject.sdk.drivers.ReportingDriver;
import io.testproject.sdk.interfaces.junit5.ExceptionsReporter;
import java.lang.Exception;
import java.lang.Override;
import java.lang.String;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.interactions.Actions;

/**
 * This class was automatically generated by TestProject
 * Project: Xattax-Group Test Cases
 * Test: TC-05-Xattax-To Be Generated Invoice
 * Generated by: Suganya Jothiprakash (suganya.sugan@sailotech.net)
 * Generated on Fri Dec 17 18:43:13 GMT 2021.
 */
public class Tc05xattaxtoBeGeneratedInvoice implements Test, ExceptionsReporter {
  public static WebDriver driver;

  /**
   * ApplicationURL test parameter
   */
  public String ApplicationURL = "http://175.101.240.71:9791/XATTAXEInvoice1.5/login";

  /**
   * Username test parameter
   */
  public String Username = "einvuser1";

  /**
   * Password test parameter
   */
  public String Password = "1234";

  /**
   * GeneratedInvoiceSearcField test parameter
   */
  public String GeneratedInvoiceSearcField = "ABPS012889";

  /**
   * Path test parameter
   */
  public String Path = "C:\\Users\\sukki\\Dropbox\\My PC (DESKTOP-A4GJKOM)\\Desktop\\Xattax Excel Files\\E_Invoice_XLSX_SampleData.xlsx";

  /**
   * ImportSearchInvoice test parameter
   */
  public String ImportSearchInvoice = "E_Invoice_SampleTemplate (9).xlsx";

  /**
   * TransactionSummary test parameter
   */
  public String TransactionSummary = "";

  /**
   * RecordDetails test parameter
   */
  public String RecordDetails = "";

  /**
   * SendEmail test parameter
   */
  public String SendEmail = "suganya.sugan@sailotech.net";

  /**
   * TransID test parameter
   */
  public String TransID = "01AMBPG7773M002";

  /**
   * TransName test parameter
   */
  public String TransName = "A";

  /**
   * Distance test parameter
   */
  public String Distance = "351";

  /**
   * VehicleNumber test parameter
   */
  public String VehicleNumber = "AP20AG1234";

  /**
   * TransDocNumber test parameter
   */
  public String TransDocNumber = "324";

  /**
   * TransDocDate test parameter
   */
  public String TransDocDate = "12/10/2021";

  /**
   * ShippingToLocation test parameter
   */
  public String ShippingToLocation = "Other country";

  /**
   * ShippingToAddress2 test parameter
   */
  public String ShippingToAddress2 = "Chandigargh";

  /**
   * ShippingPincode test parameter
   */
  public String ShippingPincode = "160001";

  /**
   * ShippingToAddress1 test parameter
   */
  public String ShippingToAddress1 = "Punjab";

  /**
   * ToBeGeneratedSearchField test parameter
   */
  public String ToBeGeneratedSearchField = "124568";

  public void execute(WebDriver parentDriver) throws Exception {
    driver = parentDriver;
    // set timeout for driver actions (similar to step timeout)
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);
    By by;
    boolean booleanResult;
    VisibleElementsOperations.GetTextIfVisibleWeb getTextIfVisibleWeb;
    VisibleElementsOperations.ClickIfVisibleWeb clickIfVisibleWeb;

    // 1. Click 'To be Generated'
    //    Click on Generated Tab
    // set step-specific timeout (will undo this at the end)
    driver.manage().timeouts().implicitlyWait(25000, TimeUnit.MILLISECONDS);
    GeneratedUtils.sleep(1000);
    by = By.xpath("//a[. = ' To be Generated ']");
    driver.findElement(by).click();
    driver.manage().timeouts().implicitlyWait(15000, TimeUnit.MILLISECONDS);

    // 2. Click 'INPUT3'
    //    Click on Search Field in To Be Generated Tab
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[3]/div/div/div/div/div//input");
    driver.findElement(by).click();

    // 3. Type '{{ToBeGeneratedSearchField}}' in 'INPUT3'
    //    Enter the Value for in Search Field
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[3]/div/div/div/div/div//input");
    driver.findElement(by).sendKeys(ToBeGeneratedSearchField);

    // 4. Send 'ENTER' key(s)
    //    Press on the Enter Key
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[3]/div/div/div/div/div//input");
    (new Actions(driver)).sendKeys(GeneratedUtils.getKeys("ENTER")).build().perform();

    // 5. Click 'I1'
    //    Click on Edit Icon
    GeneratedUtils.sleep(500);
    by = By.xpath("//div[3]/div/div/div/div/div/table/tbody/tr/td[8]/button[1]/i");
    driver.findElement(by).click();

    // 6. Click 'Generate IRN' if it's visible
    //    Click on Generate IRN Button
    GeneratedUtils.sleep(500);
    clickIfVisibleWeb = VisibleElementsOperations.clickIfVisibleWeb("");
    by = By.cssSelector("#generate");
    clickIfVisibleWeb = (VisibleElementsOperations.ClickIfVisibleWeb)((ReportingDriver)driver).addons().execute(clickIfVisibleWeb, by, -1);

    // 7. Click '2278 - IRN is already generated and i...' if it's visible
    //    Click on Text Message
    GeneratedUtils.sleep(500);
    clickIfVisibleWeb = VisibleElementsOperations.clickIfVisibleWeb("");
    by = By.xpath("//div[. = ' 2278 - IRN is already generated and is cancelled for this Document number. The duplicate IRN cannot be generated for the same  number.  ']");
    clickIfVisibleWeb = (VisibleElementsOperations.ClickIfVisibleWeb)((ReportingDriver)driver).addons().execute(clickIfVisibleWeb, by, -1);

    // 8. Get text from '2278 - IRN is already generated and i...' if it's visible
    //    Get the Text from Pop Up Message
    GeneratedUtils.sleep(500);
    getTextIfVisibleWeb = VisibleElementsOperations.getTextIfVisibleWeb("");
    by = By.xpath("//div[. = ' 2278 - IRN is already generated and is cancelled for this Document number. The duplicate IRN cannot be generated for the same  number.  ']");
    getTextIfVisibleWeb = (VisibleElementsOperations.GetTextIfVisibleWeb)((ReportingDriver)driver).addons().execute(getTextIfVisibleWeb, by, -1);

    // 9. Click 'Back To Queue'
    //    Click on Back to Queue
    GeneratedUtils.sleep(500);
    //by = By.xpath("//a[. = ' Back To Queue ']");
    by = By.xpath("//*[starts-with(@class,\"fa fa-arrow-left\")]");
    driver.findElement(by).click();

  }

  @Override
  public ReportingDriver getDriver() {
    return (ReportingDriver) driver;
  }
}
